@{Layout = null;}@model IEnumerable<McoEasyTool.Application_Report>
<script type="text/javascript">
    jQuery(document).ready(function () {
        APP_CONTROLLER = "McoApp/";
        APP_MODULE = "APP";

        var FIRST_ENTRY = 0;
        var LEFT_ENTRY = 0;
        var RIGHT_ENTRY = 0;
        var LAST_ENTRY = 0;

        FIRST_ENTRY = "@ViewBag.First_Entry";
        LEFT_ENTRY = "@ViewBag.Left_Entry";
        RIGHT_ENTRY = "@ViewBag.Right_Entry";
        LAST_ENTRY = "@ViewBag.Last_Entry";

        get_arrows(APP_MCO_DIV, APP_CONTROLLER + "DisplayReportDetails/", FIRST_ENTRY, LEFT_ENTRY, RIGHT_ENTRY, LAST_ENTRY);

        $("#mco-app-div .item-summary-tr").each(function () {
            status = $(this).find("td").eq(1).text().trim();
            if (status == "OK") {
                $(this).css("background-color", "#22b14c");
            }
            else {
                if (status == "H-OK") {
                    $(this).css("background-color", "#de5a26");
                }
                else {
                    if (status == "KO") {
                        $(this).css("background-color", "#ff3f3f");
                    }
                    else {
                        $(this).css("background-color", "#a3a3a3");
                    }
                }
            }
            $(this).find("td").each(function () {
                $(this).css("color", "#fff");
            });
        });

        $("#mco-app-div .start-order-infos").each(function () {
            infos = $(this).val().split(";");
            display = "";
            for (index = 0; index < infos.length; index++) {
                if (infos[index].trim() != "") {
                    display += "<tr><td>" + (index + 1) + "- " + infos[index].trim() + "</td></tr>";
                }
            }
            $(this).val(display);
        });

        $("#mco-app-div .stop-order-infos").each(function () {
            if ($(this).val().trim() != "") {
                infos = $(this).val().split(";");
                display = "";
                for (index = 0; index < infos.length; index++) {
                    if (infos[index].trim() != "") {
                        display += "<tr><td>" + (index + 1) + "- " + infos[index].trim() + "</td></tr>";
                    }
                }
            }
            else {
                display = "Vide";
            }
            $(this).val(display);
        });

        $("#mco-app-div .item-summary-tr").click(function () {
            reportId = $(this).find(".previous-id-getter").val();
            appreportId = $(this).find(".action-id-getter").val();
            $.ajax({
                url: SITENAME + APP_CONTROLLER + 'DisplayReportFurtherDetails/' + appreportId,
                data: { origin: "DisplayReportDetails" },
                type: "POST",
                success: function (data) {
                    APP_MCO_DIV.html(data);
                },
                error: function (errorThrown) {
                    alert('Erreur lors de communication avec le serveur');
                },
                complete: function () { colourTitles(); }
            });
        });

        $("#mco-app-div .previous-link").click(function () {
            NAV_APP_REPORTS_BTN.trigger("click");
        });
    });
</script>

<hgroup>
    <h2 class="page-title">Check du @ViewBag.Message</h2>
</hgroup>
<p class="page-title-info warning"></p>
<a class="previous-link">Précédent</a>
<table id="appreport-table" class="item-summary">
    <thead>
        <tr class="item-summary-thead">
            <th>Applications</th>
            <th>Etat</th>
            <th>Authentification</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
@foreach (var item in Model) {
    <tr class="item-summary-tr" title="Cliquez pour obtenir plus de détails sur ce résultat : @item.Application.Name">
        <td class="applicationviewer">
            @Html.TextBox("action-id-getter-" + item.Id, item.Id, new { @disabled = "disabled", @class = "action-id-getter" })
            @Html.TextBox("previous-id-getter-" + item.AppReport.Id, item.AppReport.Id, new { @disabled = "disabled", @class = "previous-id-getter" })
            @Html.DisplayFor(modelItem => item.Application.Name)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.State)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Authentified)
        </td>
        <td style="margin:0px;padding:0px;">
            @if (item.State == "OK" || item.State == "KO" || item.State == "H-OK"){
                @Html.TextBox("action-id-getter-" + item.Id, item.Id, new { @disabled = "disabled", @class = "action-id-getter" })
                <div class="action-div">
                    <div class="action-icon details-viewer" title="voir plus de details"></div>
                </div>
            }               
         </td>
    </tr>
}
</tbody>
</table>
<a class="previous-link">Précédent</a>